// Helper method to parse date, converting empty string to null
private Date parseDate(String dateStr) {
    if (dateStr == null || dateStr.trim().isEmpty()) {
        return null;
    }
    try {
        return dateFormat.parse(dateStr);
    } catch (ParseException e) {
        throw new IllegalArgumentException("Invalid date format: " + dateStr, e);
    }
}
