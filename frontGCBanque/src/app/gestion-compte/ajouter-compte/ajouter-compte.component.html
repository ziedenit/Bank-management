@Service
public class FinancementService {

    @Autowired
    private FinancementRepository financementRepository;

    public Financement patchFinancement(String idFinancement, Financement financementToUpdate) {
        // Récupérer le financement à partir de la base de données
        Financement financement = financementRepository.findById(idFinancement)
                .orElseThrow(() -> new RuntimeException("Financement non trouvé avec l'ID : " + idFinancement));

        // Mettre à jour tous les champs de l'objet principal
        updateFields(financement, financementToUpdate);

        // Sauvegarder le financement mis à jour dans la base de données
        Financement financementMisAJour = financementRepository.save(financement);

        return financementMisAJour;
    }

    private void updateFields(Financement financement, Financement financementToUpdate) {
        if (financementToUpdate.getIdFinancement() != null) {
            financement.setIdFinancement(financementToUpdate.getIdFinancement());
        }
        // Mettre à jour les champs de l'objet principal
        // Vous pouvez continuer pour les autres champs de Financement

        // Mettre à jour les champs de l'objet ObjetFinancement
        if (financementToUpdate.getObjetFinancement() != null) {
            updateObjetFinancementFields(financement.getObjetFinancement(), financementToUpdate.getObjetFinancement());
        }

        // Ajoutez d'autres mises à jour pour les objets imbriqués si nécessaire
    }

    private void updateObjetFinancementFields(ObjetFinancement objetFinancement, ObjetFinancement objetFinancementToUpdate) {
        if (objetFinancementToUpdate.getIdObjetFinancement() != null) {
            objetFinancement.setIdObjetFinancement(objetFinancementToUpdate.getIdObjetFinancement());
        }
        // Mettre à jour les champs de l'objet ObjetFinancement
        // Vous pouvez continuer pour les autres champs d'ObjetFinancement

        // Mettre à jour les champs du bien
        if (objetFinancementToUpdate.getBien() != null) {
            updateBienFields(objetFinancement.getBien(), objetFinancementToUpdate.getBien());
        }

        // Ajoutez d'autres mises à jour pour les objets imbriqués si nécessaire
    }

    private void updateBienFields(Bien bien, Bien bienToUpdate) {
        if (bienToUpdate.getSurfaceBien() != null) {
            bien.setSurfaceBien(bienToUpdate.getSurfaceBien());
        }
        // Mettre à jour les champs du bien
        // Vous pouvez continuer pour les autres champs de Bien

        // Ajoutez d'autres mises à jour pour les objets imbriqués si nécessaire
    }

    // Ajoutez d'autres méthodes de mise à jour pour les objets imbriqués si nécessaire
}
