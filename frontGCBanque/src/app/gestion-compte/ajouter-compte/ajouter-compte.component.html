private void merge(Object target, Object source) throws Exception {
    Field[] fields = source.getClass().getDeclaredFields();
    ArrayList<String> bienFields = new ArrayList<>(Arrays.asList("codeBatiment", "typeBatiment", "numeroVoie", "typeVoie", "nomRue", "batiment", "escalier", "etage", "porte", "codePostal", "nomCommune",
            "paysBien", "adresseComplete", "codeNormeThermique", "etatBien", "typeEnergie", "codeTypeEnergie", "codeDepartement", "codeInseeCommune",
            "numeroLot", "numeroNomRue", "typeUsage", "anneeConstruction", "periodeConstruction", "dateDepotPc", "dateDebutConstruction", "surfaceBien",
            "numeroFiscalLocal", "coordonneeCartographiqueX", "coordonneeCartographiqueY", "prixBien", "montantFinanceLCL", "partLCL"));

    ArrayList<String> dpeFields = new ArrayList<>(Arrays.asList("numeroDpe", "estimationCep", "classeCep", "estimationGes", "classeGes", "dateEtablissementDpe",
            "dateReceptionDpe", "dateFinValiditeDpe", "sirenDiagnostiqueur"));

    for (Field field : fields) {
        field.setAccessible(true);
        try {
            Object value = field.get(source);
            if (value != null) {
                handleNonNullField(target, field, value, bienFields, dpeFields);
            } else {
                handleNullField(target, field, bienFields, dpeFields);
            }
        } catch (IllegalAccessException e) {
            throw new PatchFinancementException("Failed to merge field: " + e.getMessage());
        }
    }
}

private void handleNonNullField(Object target, Field field, Object value, ArrayList<String> bienFields, ArrayList<String> dpeFields) throws IllegalAccessException {
    if (isComplexObject(field.getType())) {
        Object targetValue = field.get(target);
        if (targetValue == null) {
            field.set(target, value);
        } else {
            merge(targetValue, value);
        }
    } else {
        if (field.getType().equals(Date.class)) {
            field.set(target, value);
        } else {
            field.set(target, value);
        }
    }
}

private void handleNullField(Object target, Field field, ArrayList<String> bienFields, ArrayList<String> dpeFields) throws IllegalAccessException {
    if (field.getType().equals(Date.class)) {
        field.set(target, null);
    }

    if (bienFields.contains(field.getName())) {
        field.set(target, null);
    }

    if (dpeFields.contains(field.getName())) {
        field.set(target, null);
    }
}

private boolean isComplexObject(Class<?> type) {
    return !type.isPrimitive() && !type.getName().startsWith("java.lang") && !type.getName().startsWith("java.util");
}
