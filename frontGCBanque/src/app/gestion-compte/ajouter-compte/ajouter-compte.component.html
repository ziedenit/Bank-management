import java.util.Date;
import java.text.ParseException;
import java.text.SimpleDateFormat;
import java.lang.reflect.Field;

private void merge(Object target, Object source) {
    Field[] fields = source.getClass().getDeclaredFields();

    for (Field field : fields) {
        field.setAccessible(true);
        try {
            Object value = field.get(source);
            if (value != null) {
                if (value instanceof String && ((String) value).trim().isEmpty()) {
                    // If the value is a string and it's empty, set the target field to null
                    field.set(target, null);
                } else if (isComplexObject(field.getType())) {
                    Object targetValue = field.get(target);
                    if (targetValue == null) {
                        field.set(target, value);
                    } else {
                        merge(targetValue, value);
                    }
                } else if (field.getType() == Date.class) {
                    if (value instanceof String) {
                        // If the value is a string and empty, set the target field to null
                        if (((String) value).trim().isEmpty()) {
                            field.set(target, null);
                        } else {
                            // Otherwise, parse the string and set the date field
                            SimpleDateFormat dateFormat = new SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss.SSSXXX");
                            Date parsedDate = dateFormat.parse((String) value);
                            field.set(target, parsedDate);
                        }
                    } else {
                        // If the value is not a string, directly set the date field
                        field.set(target, value);
                    }
                } else {
                    field.set(target, value);
                }
            }
        } catch (IllegalAccessException | ParseException e) {
            throw new RuntimeException("Failed to merge field: " + field.getName(), e);
        }
    }
}
